@page
@model IndexModel
@{
    ViewData["Title"] = "User Behavior";
}

<h2>Flight Booking Behavior</h2>

<table class="table table-bordered">
    <thead>
        <tr>
            <th>User</th>
            <th>Session</th>
            <th>Pages</th>
            <th>Origin</th>
            <th>Dest</th>
            <th>Booked</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var user in Model.UserList)
        {
            <tr>
                <td>@user.UserId</td>
                <td>@user.SessionDuration</td>
                <td>@user.PagesVisited</td>
                <td>@user.SearchOrigin</td>
                <td>@user.SearchDestination</td>
                <td>@(user.BookingMade ? "✔" : "❌")</td>
            </tr>
        }
    </tbody>
</table>


<canvas id="chartDest"></canvas>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    fetch('/api/data/top-destinations')
        .then(response => response.json())
        .then(data => {
            new Chart(document.getElementById('chartDest'), {
                type: 'bar',
                data: {
                    labels: data.labels,
                    datasets: [{
                        label: 'Top Destinations',
                        data: data.counts,
                        backgroundColor: 'rgba(75, 192, 192, 0.6)'
                    }]
                }
            });
        });
</script>
